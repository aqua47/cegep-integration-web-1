version: 2.1

jobs:
  build:
    parameters:
      name:
        type: string
    machine: true
    steps:
      - run: echo "Ex√©cution de << parameters.name >>"

workflows:
  delivery_pipeline:
    jobs:
      - build:
          name: checkout_and_unit_test
      - build:
          name: deploy_backend
          requires: [checkout_and_unit_test]
      - build:
          name: integration_tests_backend
          requires: [deploy_backend]
      - build:
          name: deploy_staging
          requires: [integration_tests_backend]
      

      - build:
          name: acceptance_tests_1
          requires: [deploy_staging]
      - build:
          name: acceptance_tests_2
          requires: [deploy_staging]
      - build:
          name: acceptance_tests_3
          requires: [deploy_staging]
      - build:
          name: acceptance_tests_4
          requires: [deploy_staging]
      

      - build:
          name: deploy_production
          requires:
            - acceptance_tests_1
            - acceptance_tests_2
            - acceptance_tests_3
            - acceptance_tests_4